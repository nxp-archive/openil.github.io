<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title></title>
    <meta name="keywords" content=""/>
    <meta name="description" content=""/>
    <meta http-equiv="pragma" content="no-cache"/>
    <!-- Mobile Specific Metas  ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" type="text/css" href="../../bootstrap/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../style.css" media="screen, projection"/>
    <link rel="stylesheet" type="text/css" href="../../jcarousel_skin.css">
    <link rel="stylesheet" type="text/css" href="../../preloader/css/preloader.css"/>
    <link rel="stylesheet" type="text/css" href="../../prettyPhoto/css/prettyPhoto.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/menusm.css"/>
    <link rel="stylesheet" type="text/css" href="../../ui_totop/css/ui.totop.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/layout.css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,600,700,800,300&subset=latin,cyrillic'
          rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Six+Caps' rel='stylesheet' type='text/css'>
    <style>
        iframe body{font-size:14px;}
    </style>
</head>

<body>
    <div id="wrapper">
        <div id="header">
            <div class="navbar navbar-fixed-top">
                <div class="container">
                    <div class="navbar-inner"><a class="brand" href="/openil/index.html">OpenIL</a>
                        <div class="menu">
                            <script type="text/javascript" src="../../js/menu_html_block.js?v=0.02"></script>
                        </div>
                    </div>
                </div>
                <!--navbar-->
            </div>
        </div>

        <!-- #header-->
        <div class="clr"></div>
        <div id="content" class="nogap container">
            <div class="row">
                <div class="separator"></div>
                <h1 class="text-center extrabold">users -- OPENIL usage discussions</h1>
                <h2 class="sub-title" style="background: rgb(255, 240, 208);padding: 0 10px;font-weight:bold;">unSubscribing to users</h2>
                <p style="font-size:12px;">unsubscribe to users by filling out the following form. You will be sent email requesting confirmation, to prevent others
                    from gratuitously unsubscribing you. This is a hidden list, which means that the list of members is available only to the list administrator.</p>
                <div class="separator custom-content js-custom-content">
                    <form class="form-horizontal  js-mail-subscribe" action="" method="post" target="hidefrm">
                        <input type="hidden" name="subscribeState" id="subscribeState" value='1'>
                        <input type="hidden" name="mailingList" id="mailingList" value=''>
                        <div class="control-group">
                            <label class="control-label" for="userEmailAddr">
                                Your email address:</label>
                            <div class="controls">
                                <input type="email" id="userEmailAddr" name="userEmailAddr" placeholder="Your email address" class="input-xlarge">
                                &nbsp;&nbsp;<button type="button" class="btn js-Unsubscribe" disabled>Unsubscribe</button>
                            </div>
                            <div class="control-group">
                                <div class="controls">
                                    <p id="spinfo" style="margin-top: 1em;"></p>
                                </div>
                            </div>
                        </div>
                    </form>

                </div>
            </div>
        </div>
        <!-- #content-->

    </div>
    <!-- #wrapper -->

    <div id="footer">
        <div class="container">
            <div class="cols">
                <div class="row">
                    <div class="span4 offset2">
                        <h4>Stay Connected</h4>
                        <div class="post"><span>""</span>
                            <p> <a href="mailto:""">""</a><br />
            </p>
                            <br/>
                        </div>
                    </div>
                    <!--<div class="span4">-->
                        <!-- <h4>Subscribe to our Newsletter</h4>
                        <p>Sign up to receive email notifications of news and events from OpenIl.org.</p>
                        <form id="subscribe" name="subscribe" action="#" method="post" class="validate" target="_blank">
                            <div class="input-append">
                                <input type="email" id="email" name="email" placeholder="Your Email">
                                <button class="subscribe-button btn" type="submit">SUBSCRIBE</button>
                            </div>
                        </form>
                        <div class="social">
                            <h4>follow us</h4>
                            <a class="soc1" href="#"></a> <a class="soc2" href="#"></a> <a class="soc3" href="#"></a> <a
                                class="soc4" href="#"></a> <a class="soc5" href="#"></a> <a class="soc6" href="#"></a> <a
                                class="soc7" href="#"></a> <a class="soc8" href="#"></a> <a class="soc9" href="#"></a></div>
                        <div class="clr"></div> -->
                    <!--</div>-->
                    <div class="span4">
                        <div class="lastcol">
                            <h4>Key Technologies</h4>
                            <span class="label">Linux</span>
                            <span class="label label-success">TSN</span>
                            <span class="label label-warning">IEEE 1588</span>
                            <span class="label label-important">Security</span>
                            <span class="label label-info">Xenomai</span>
                            <span class="label label-inverse">IoT</span>
                            <span class="label">Industrial</span>
                            <span class="label label-success">Real-Time</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- container cols -->
        <script type="text/javascript" src="../../js/utilities.js"></script>
        <script type="text/javascript">display_copyright()</script>
    </div>
    <!-- #footer -->



    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
    <script type="text/javascript" src="../../js/jquery.jcarousel.min.js"></script>
    <script type="text/javascript" src="../../bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../prettyPhoto/js/jquery.prettyPhoto.js"></script>
    <script type="text/javascript" src="../../js/menusm.js?v=0.01"></script>
    <script type="text/javascript" src="../../js/scripts.js"></script>
    <script type="text/javascript" src="../../ui_totop/js/jquery.ui.totop.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../preloader/js/jquery.preloader.js" charset="utf-8"></script>
    <script type="text/javascript" src="../../js/tinynav.min.js"></script>
    <script type="text/javascript">

    var aws_send_mailing_list_subscribe_url="https://wvpkul46d8.execute-api.us-west-2.amazonaws.com/prod/mailing-list-send-mailing";

    //get url params
    (function ($) {
        $.getUrlParam = function (name) {
            var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);
            if (r != null) return unescape(r[2]); return null;
        };
        $.mailInvalid=function(name){
            var state = false;
            name.focus(function () {
                if (state == false) {
                    $(this).val('');
                    $('#spinfo').attr("state","");
                }
            })
            name.blur(function () {
                if ($(this).val() == '') {
                    $('#spinfo').text('The mailbox cannot be empty').css("color","#f00");
                    $(this).focus();
                    $('#spinfo').attr("state","");
                }
                else {
                    if (/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test($(this).val()) == false) {
                        $('#spinfo').text('The email format is incorrect!').css("color","#f00");
                        $(this).focus();
                        $('#spinfo').attr("state","");
                    }
                    else {
                        $('#spinfo').text('Validating email address ...').css("color","black");
                        var email = $(this).val()
                        var role = $.getUrlParam('mailingList')
                         var is_member_url = "https://wvpkul46d8.execute-api.us-west-2.amazonaws.com/prod/is-member-of-role?email=" + email + "&role=" + role;
                         $.ajax({
                            type: "GET",
                            url: is_member_url,
                            crossDomain: true,
                            dataType: "json",
                            success: function (res) {
                                console.log(res)
                                if (res == 'undefined') {
                                        $("#send_result").html('Error:' + res)
                                    } else {
                                        if (res.Code === 0) {
                                            console.log(res.Result.is_member)
                                            if (res.Result.is_member == 1) {
                                                $('#spinfo').text('');
                                                $('#spinfo').append('The email format is correct').css("color", "#32c5d2").attr("state", "true");
                                                state = true;
                                                $(".js-Unsubscribe").attr("disabled", false);
                                            } else {
                                                $('#spinfo').text('you have not registered to email!').css("color", "#f00");
                                                $(this).focus();
                                                $('#spinfo').attr("state", "");
                                                $(".js-Unsubscribe").attr("disabled", true);
                                            }
                                            $("#send_result").html(res.Result)
                                        } else {
                                            $("#send_result").html('Error：<br/>' + res.Error)
                                        }
                                    }
                            },
                            error: function (data, status, error) {
                                console.log(data);
                                console.log('fail');
                            }
                        });
                    }
                }
            })
        }
    })(jQuery);
    var mailingList = $.getUrlParam('mailingList');
    $("#mailingList").val(mailingList);
    var userEmailAddr=$("#userEmailAddr");

    var userEmailAddr= $.mailInvalid($("#userEmailAddr"));

    $(".js-Unsubscribe").click(function(){
        $(".js-mail-subscribe").attr("action",aws_send_mailing_list_subscribe_url);
        var spinfo_state=$('#spinfo').attr("state");
        /* $(".js-custom-content").remove(".js-hidefrm")*/
        $(".js-hidefrm").remove();
        console.log(spinfo_state)
        if(spinfo_state=="true"){
            $('#spinfo').attr("state", "");
            $(".js-Unsubscribe").attr("disabled", true);
            $(".js-custom-content").append('<iframe src="" name="hidefrm" frameborder="0" class="hidefrm  js-hidefrm" style="margin-left: 19%;width: 100%;"> </iframe>');
            $(".js-mail-subscribe").submit();
        }

    })



</script>
</body>
</html>
